# ğŸ¸ Quáº£n LÃ½ Lá»‹ch ÄÃ¡nh Cáº§u - Badminton Session Management PWA

á»¨ng dá»¥ng Progressive Web App (PWA) quáº£n lÃ½ lá»‹ch Ä‘Ã¡nh cáº§u lÃ´ng Ä‘Æ°á»£c xÃ¢y dá»±ng vá»›i React + Firebase, hoÃ n toÃ n báº±ng tiáº¿ng Viá»‡t.

## âœ¨ TÃ­nh nÄƒng chÃ­nh

### ğŸ¯ Quáº£n lÃ½ cÆ¡ báº£n
- **Quáº£n lÃ½ sÃ¢n cáº§u lÃ´ng**: CRUD sÃ¢n vá»›i thÃ´ng tin giÃ¡ cáº£, Ä‘á»‹a chá»‰
- **Quáº£n lÃ½ thÃ nh viÃªn**: ThÃ´ng tin cÃ¡ nhÃ¢n, trÃ¬nh Ä‘á»™, lá»‹ch sá»­ tham gia
- **Quáº£n lÃ½ nhÃ³m**: Táº¡o vÃ  quáº£n lÃ½ cÃ¡c nhÃ³m thÃ nh viÃªn
- **Quáº£n lÃ½ ngÆ°á»i dÃ¹ng**: PhÃ¢n quyá»n admin/user

### ğŸ“… Quáº£n lÃ½ lá»‹ch Ä‘Ã¡nh
- **Táº¡o lá»‹ch vá»›i Stepper**: 4 bÆ°á»›c (ThÃ´ng tin â†’ ThÃ nh viÃªn â†’ Sáº£nh chá» â†’ Chi phÃ­)
- **Äiá»ƒm danh thÃ nh viÃªn**: Checkbox cho tá»«ng thÃ nh viÃªn
- **Sáº£nh chá»**: Drag & drop Ä‘á»ƒ sáº¯p xáº¿p thá»© tá»± Æ°u tiÃªn
- **Quáº£n lÃ½ chi phÃ­**: Tá»± Ä‘á»™ng tÃ­nh toÃ¡n vÃ  chia Ä‘á»u chi phÃ­
- **HoÃ n thÃ nh lá»‹ch**: Xuáº¥t thÃ´ng tin thanh toÃ¡n cho tá»«ng thÃ nh viÃªn

### ğŸ“Š BÃ¡o cÃ¡o vÃ  thá»‘ng kÃª
- **Biá»ƒu Ä‘á»“ doanh thu**: Chart.js vá»›i dá»¯ liá»‡u theo thÃ¡ng
- **Top thÃ nh viÃªn**: Thá»‘ng kÃª thÃ nh viÃªn tÃ­ch cá»±c nháº¥t
- **Sá»­ dá»¥ng sÃ¢n**: PhÃ¢n tÃ­ch táº§n suáº¥t sá»­ dá»¥ng cÃ¡c sÃ¢n
- **Xuáº¥t bÃ¡o cÃ¡o**: CSV export cho táº¥t cáº£ dá»¯ liá»‡u

### ğŸ–¼ï¸ Xuáº¥t áº£nh vÃ  chia sáº»
- **Export hÃ¬nh áº£nh**: html-to-image Ä‘á»ƒ xuáº¥t thÃ´ng tin lá»‹ch
- **Chia sáº»**: Táº¡o áº£nh summary cho má»—i lá»‹ch Ä‘Ã¡nh

## ğŸ› ï¸ CÃ´ng nghá»‡ sá»­ dá»¥ng

### Frontend
- **React 18** + **TypeScript** - UI framework
- **Material UI v5** - Component library vá»›i theme tÃ¹y chá»‰nh
- **React Router v6** - Routing
- **React Query** - Data fetching vÃ  caching
- **Formik + Yup** - Form validation
- **Chart.js** - Biá»ƒu Ä‘á»“ vÃ  thá»‘ng kÃª
- **html-to-image** - Export áº£nh
- **react-beautiful-dnd** - Drag & drop cho sáº£nh chá»

### Backend & Database
- **Firebase Authentication** - ÄÄƒng nháº­p/Ä‘Äƒng kÃ½
- **Firestore** - NoSQL database vá»›i offline persistence
- **Firebase Storage** - LÆ°u trá»¯ file
- **Cloud Functions** - Server-side logic (tÃ¹y chá»n)

### PWA Features
- **Service Worker** - Offline caching
- **Web App Manifest** - CÃ i Ä‘áº·t nhÆ° native app
- **Push Notifications** - ThÃ´ng bÃ¡o (tÃ¹y chá»n)
- **Background Sync** - Äá»“ng bá»™ dá»¯ liá»‡u offline

## ğŸš€ CÃ i Ä‘áº·t vÃ  cháº¡y

### 1. Clone repository
```bash
git clone <repository-url>
cd badminton-pwa
```

### 2. CÃ i Ä‘áº·t dependencies
```bash
npm install
```

### 3. Cáº¥u hÃ¬nh Firebase
1. Táº¡o project má»›i trÃªn [Firebase Console](https://console.firebase.google.com)
2. Báº­t Authentication vá»›i Email/Password
3. Táº¡o Firestore database
4. Copy cáº¥u hÃ¬nh Firebase vÃ o file `.env`

```bash
cp .env.example .env
```

Äiá»n thÃ´ng tin Firebase vÃ o file `.env`:
```bash
VITE_FIREBASE_API_KEY=your_api_key
VITE_FIREBASE_AUTH_DOMAIN=your_project.firebaseapp.com
VITE_FIREBASE_PROJECT_ID=your_project_id
VITE_FIREBASE_STORAGE_BUCKET=your_project.appspot.com
VITE_FIREBASE_MESSAGING_SENDER_ID=your_sender_id
VITE_FIREBASE_APP_ID=your_app_id
VITE_BACKEND_NOTI_URL="https://example.com/noti"
```

### 4. Cáº¥u hÃ¬nh Firestore Rules
```javascript
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    // ============================================
    // HELPER FUNCTIONS
    // ============================================
    
    // Kiá»ƒm tra user Ä‘Ã£ Ä‘Äƒng nháº­p
    function isSignedIn() {
      return request.auth != null;
    }
    
    // Kiá»ƒm tra user cÃ³ pháº£i admin khÃ´ng
    function isAdmin() {
      return isSignedIn() && 
             get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';
    }
    
    // Kiá»ƒm tra user cÃ³ active khÃ´ng
    function isActive() {
      return isSignedIn() && 
             get(/databases/$(database)/documents/users/$(request.auth.uid)).data.isActive == true;
    }
    
    // Kiá»ƒm tra user cÃ³ pháº£i chá»§ sá»Ÿ há»¯u document khÃ´ng
    function isOwner(userId) {
      return isSignedIn() && request.auth.uid == userId;
    }
    
    // ============================================
    // USERS COLLECTION
    // ============================================
    match /users/{userId} {
      // Äá»c: Chá»‰ user Ä‘Ã£ Ä‘Äƒng nháº­p
      allow read: if isSignedIn();
      
      // Táº¡o: Chá»‰ khi Ä‘Äƒng kÃ½ tÃ i khoáº£n má»›i (tá»± Ä‘á»™ng táº¡o document cho chÃ­nh mÃ¬nh)
      allow create: if isSignedIn() && 
                       request.auth.uid == userId &&
                       request.resource.data.role == 'user' && // Máº·c Ä‘á»‹nh lÃ  user
                       request.resource.data.isActive == true; // Máº·c Ä‘á»‹nh active
      
      // Cáº­p nháº­t: 
      // - Admin cÃ³ thá»ƒ cáº­p nháº­t báº¥t ká»³ user nÃ o
      // - User chá»‰ cÃ³ thá»ƒ cáº­p nháº­t thÃ´ng tin cÃ¡ nhÃ¢n cá»§a mÃ¬nh (KHÃ”NG Ä‘Æ°á»£c Ä‘á»•i role, isActive)
      allow update: if isAdmin() || 
                       (isOwner(userId) && 
                        request.resource.data.role == resource.data.role && // KhÃ´ng Ä‘Æ°á»£c tá»± Ä‘á»•i role
                        request.resource.data.isActive == resource.data.isActive); // KhÃ´ng Ä‘Æ°á»£c tá»± Ä‘á»•i isActive
      
      // XÃ³a: Chá»‰ admin
      allow delete: if isAdmin();
    }
    
    // ============================================
    // COURTS COLLECTION
    // ============================================
    match /courts/{courtId} {
      // Äá»c: User Ä‘Ã£ Ä‘Äƒng nháº­p vÃ  active
      allow read: if isActive();
      
      // Táº¡o/Cáº­p nháº­t/XÃ³a: Chá»‰ admin
      allow create, update, delete: if isAdmin();
    }
    
    // ============================================
    // MEMBERS COLLECTION
    // ============================================
    match /members/{memberId} {
      // Äá»c: User Ä‘Ã£ Ä‘Äƒng nháº­p vÃ  active
      allow read: if isActive();
      
      // Táº¡o/Cáº­p nháº­t/XÃ³a: Chá»‰ admin
      allow create, update, delete: if isAdmin();
    }
    
    // ============================================
    // GROUPS COLLECTION
    // ============================================
    match /groups/{groupId} {
      // Äá»c: User Ä‘Ã£ Ä‘Äƒng nháº­p vÃ  active
      allow read: if isActive();
      
      // Táº¡o/Cáº­p nháº­t/XÃ³a: Chá»‰ admin
      allow create, update, delete: if isAdmin();
    }
    
    // ============================================
    // SESSIONS COLLECTION
    // ============================================
    match /sessions/{sessionId} {
      // Äá»c: User Ä‘Ã£ Ä‘Äƒng nháº­p vÃ  active
      allow read: if isActive();
      
      // Táº¡o: User active cÃ³ thá»ƒ táº¡o session
      allow create: if isActive() && 
                       request.resource.data.createdBy == request.auth.uid;
      
      // Cáº­p nháº­t: 
      // - Admin cÃ³ thá»ƒ cáº­p nháº­t báº¥t ká»³ session nÃ o
      // - User chá»‰ cÃ³ thá»ƒ cáº­p nháº­t session cá»§a mÃ¬nh
      allow update: if isActive() && 
                       (isAdmin() || resource.data.createdBy == request.auth.uid);
      
      // XÃ³a:
      // - Admin cÃ³ thá»ƒ xÃ³a báº¥t ká»³ session nÃ o
      // - User chá»‰ cÃ³ thá»ƒ xÃ³a session cá»§a mÃ¬nh
      allow delete: if isActive() && 
                       (isAdmin() || resource.data.createdBy == request.auth.uid);
    }
    
    // ============================================
    // SETTINGS COLLECTION
    // ============================================
    match /settings/{settingId} {
      // Äá»c: Táº¥t cáº£ user Ä‘Ã£ Ä‘Äƒng nháº­p vÃ  active cÃ³ thá»ƒ Ä‘á»c settings
      allow read: if isActive();
      
      // Táº¡o/Cáº­p nháº­t/XÃ³a: Chá»‰ admin
      // Settings lÃ  cáº¥u hÃ¬nh há»‡ thá»‘ng, chá»‰ admin Ä‘Æ°á»£c thay Ä‘á»•i
      allow create, update, delete: if isAdmin();
    }
    
    // ============================================
    // DEFAULT: DENY ALL
    // ============================================
    // Má»i collection khÃ¡c Ä‘á»u bá»‹ tá»« chá»‘i truy cáº­p
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
```

### 5. Cháº¡y á»©ng dá»¥ng

#### Development
```bash
npm run dev
```

#### Production build
```bash
npm run build
npm run preview
```

## ğŸ“± PWA Installation

á»¨ng dá»¥ng há»— trá»£ cÃ i Ä‘áº·t nhÆ° native app:

1. Má»Ÿ á»©ng dá»¥ng trÃªn browser (Chrome, Edge, Safari)
2. Click "CÃ i Ä‘áº·t" khi popup xuáº¥t hiá»‡n
3. Hoáº·c dÃ¹ng menu "Add to Home Screen" cá»§a browser

## ğŸ¨ Giao diá»‡n vÃ  UX

### Theme
- **Primary Color**: Green (#4caf50) - Ä‘áº·c trÆ°ng cáº§u lÃ´ng
- **Dark/Light Mode**: Toggle Ä‘áº§y Ä‘á»§
- **Typography**: Inter font vá»›i cÃ¡c size chuáº©n
- **Border Radius**: 12px cho modern look

### Components
- **AppBar + Drawer**: Navigation layout responsive
- **DataGrid**: Hiá»ƒn thá»‹ dá»¯ liá»‡u vá»›i search, filter, export
- **Stepper**: Form táº¡o lá»‹ch 4 bÆ°á»›c
- **Dialog**: Modal forms thay vÃ¬ redirect pages
- **Drag & Drop**: Sáº¯p xáº¿p sáº£nh chá»
- **Charts**: Bar vÃ  Doughnut charts cho bÃ¡o cÃ¡o

### Mobile-first
- Responsive design cho táº¥t cáº£ mÃ n hÃ¬nh
- Touch-friendly interface
- Drawer navigation cho mobile
- Optimized performance

## ğŸ“Š Database Schema

### Collections

#### `users`
```typescript
{
  id: string;
  email: string;
  displayName: string;
  role: 'admin' | 'user';
  photoURL?: string;
  createdAt: Date;
  updatedAt: Date;
}
```

#### `courts`
```typescript
{
  id: string;
  name: string;
  location: string;
  pricePerHour: number;
  description?: string;
  isActive: boolean;
  createdAt: Date;
  updatedAt: Date;
}
```

#### `members`
```typescript
{
  id: string;
  name: string;
  email?: string;
  phone?: string;
  skillLevel: 'Pot 5 '| 'Pot 4' | 'Pot 3' | 'Pot 2' | 'Pot 1';
  joinDate: Date;
  isActive: boolean;
  notes?: string;
  createdAt: Date;
  updatedAt: Date;
}
```

#### `sessions`
```typescript
{
  id: string;
  name: string;
  courtId: string;
  date: Date;
  startTime: string;
  endTime: string;
  maxParticipants: number;
  currentParticipants: number;
  status: 'scheduled' | 'ongoing' | 'completed' | 'cancelled';
  members: SessionMember[];
  waitingList: WaitingListMember[];
  expenses: SessionExpense[];
  totalCost: number;
  costPerPerson: number;
  settlements: Settlement[];
  notes?: string;
  createdBy: string;
  createdAt: Date;
  updatedAt: Date;
}
```

## ğŸ”§ Scripts

```bash
# Development
npm run dev              # Start dev server
npm run build           # Build for production
npm run preview         # Preview production build
npm run lint           # Run ESLint

# Firebase
firebase deploy        # Deploy to Firebase Hosting
firebase emulators:start # Run local emulators
```

## ğŸŒŸ TÃ­nh nÄƒng ná»•i báº­t

### 1. Offline-first
- Firestore offline persistence
- Service Worker caching
- Background sync khi cÃ³ káº¿t ná»‘i

### 2. Real-time
- Real-time updates tá»« Firestore
- React Query caching vÃ  synchronization
- Optimistic updates

### 3. Mobile-friendly
- PWA cÃ i Ä‘áº·t Ä‘Æ°á»£c
- Touch gestures
- Responsive design
- Fast loading

### 4. Production-ready
- TypeScript cho type safety
- Error boundaries
- Loading states
- Form validation
- Security rules

## ğŸ“ Cáº¥u trÃºc project

```
src/
â”œâ”€â”€ components/          # Shared components
â”‚   â”œâ”€â”€ Layout.tsx      # Main app layout
â”‚   â””â”€â”€ SessionForm.tsx # Session creation form
â”œâ”€â”€ contexts/           # React contexts
â”‚   â””â”€â”€ AuthContext.tsx # Authentication context
â”œâ”€â”€ hooks/              # Custom hooks
â”‚   â””â”€â”€ index.ts       # React Query hooks
â”œâ”€â”€ pages/              # Page components
â”‚   â”œâ”€â”€ Dashboard.tsx   # Dashboard page
â”‚   â”œâ”€â”€ Courts.tsx     # Courts management
â”‚   â”œâ”€â”€ Members.tsx    # Members management
â”‚   â”œâ”€â”€ Groups.tsx     # Groups management
â”‚   â”œâ”€â”€ Sessions.tsx   # Sessions management
â”‚   â”œâ”€â”€ SessionDetail.tsx # Session detail view
â”‚   â”œâ”€â”€ Reports.tsx    # Reports and analytics
â”‚   â”œâ”€â”€ AdminUsers.tsx # User management
â”‚   â””â”€â”€ Settings.tsx   # System settings
â”œâ”€â”€ types/              # TypeScript types
â”‚   â””â”€â”€ index.ts       # Type definitions
â”œâ”€â”€ utils/              # Utility functions
â”‚   â””â”€â”€ index.ts       # Helper functions
â”œâ”€â”€ config/             # Configuration
â”‚   â””â”€â”€ firebase.ts    # Firebase config
â”œâ”€â”€ theme/              # MUI theme
â”‚   â””â”€â”€ index.ts       # Theme configuration
â”œâ”€â”€ App.tsx            # Main app component
â””â”€â”€ main.tsx           # Entry point
```

## ğŸ” Security

- **Authentication**: Firebase Auth vá»›i email/password
- **Authorization**: Role-based access control
- **Firestore Rules**: Secure database access
- **Input Validation**: Client vÃ  server-side validation
- **XSS Protection**: Sanitized inputs

## ğŸš€ Deployment

### Firebase Hosting
```bash
# Build vÃ  deploy
npm run build
firebase deploy
```

### Vercel/Netlify
1. Connect repository
2. Set build command: `npm run build`
3. Set output directory: `dist`
4. Add environment variables

## ğŸ“± PWA Features

- âœ… **Installable**: Add to home screen
- âœ… **Offline support**: Service worker caching
- âœ… **Responsive**: Mobile-first design  
- âœ… **Fast loading**: Code splitting vÃ  lazy loading
- âœ… **App-like**: Standalone display mode
- âœ… **Shortcuts**: Quick actions tá»« home screen

## ğŸ¯ Roadmap

- [ ] Push notifications cho lá»‹ch sáº¯p tá»›i
- [ ] Export PDF cho settlements
- [ ] TÃ­ch há»£p payment gateway
- [ ] Chat trong lá»‹ch Ä‘Ã¡nh
- [ ] ÄÃ¡nh giÃ¡ vÃ  feedback
- [ ] Machine learning cho gá»£i Ã½ nhÃ³m

## ğŸ“„ License

MIT License - see LICENSE file for details

## ğŸ¤ Contributing

1. Fork repository
2. Create feature branch
3. Commit changes
4. Create pull request

---

**PhÃ¡t triá»ƒn bá»Ÿi**: Chien Nguyen
**LiÃªn há»‡**: chiennq.dev@gmail.com